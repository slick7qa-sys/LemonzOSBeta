#!/bin/bash
set -e

echo "LemonzOS: Finalizing configuration..."

# 1. Set the hostname
echo "lemonzos" > /etc/hostname

# 2. Create the network directory (THE FIX)
mkdir -p /etc/systemd/network/

# 3. Configure networking
cat <<EOF > /etc/systemd/network/20-wired.network
[Match]
Name=en* eth*

[Network]
DHCP=yes
EOF

# 4. Create a default user
if ! id "lemon" &>/dev/null; then
    useradd -m -s /bin/bash lemon
    echo "lemon:lemon" | chpasswd
fi

echo "LemonzOS: Post-install complete."
